1:HL["/_next/static/media/560d0dc937e89811-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/2e2b2fd34d8c61e1.css",{"as":"style"}]
0:["QzW5gFs9b83_AVVx3Fl9C",[[["",{"children":["blog",{"children":[["slug","drafts/launchd-explained","c"],{"children":["__PAGE__?{\"slug\":[\"drafts\",\"launchd-explained\"]}",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2e2b2fd34d8c61e1.css","precedence":"next"}]],"$L4"]]]]
5:HL["/_next/static/css/3b2379318c31443c.css",{"as":"style"}]
6:I{"id":8464,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"ThemeProviders","async":false}
7:I{"id":3015,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"","async":false}
8:I{"id":367,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"KBarSearchProvider","async":false}
9:I{"id":6685,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","797:static/chunks/app/blog/[...slug]/page-cadd8fdc01fae17f.js"],"name":"","async":false}
a:I{"id":7005,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"KBarButton","async":false}
b:I{"id":6914,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"","async":false}
c:I{"id":8766,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","450:static/chunks/450-50939c43153ea6c9.js","185:static/chunks/app/layout-473ea10235345fab.js"],"name":"","async":false}
d:I{"id":7767,"chunks":["272:static/chunks/webpack-9e58005a198e4d2a.js","971:static/chunks/fd9d1056-07144e4a7b41a046.js","596:static/chunks/596-f6f0737d82c1fce2.js"],"name":"default","async":false}
e:I{"id":7920,"chunks":["272:static/chunks/webpack-9e58005a198e4d2a.js","971:static/chunks/fd9d1056-07144e4a7b41a046.js","596:static/chunks/596-f6f0737d82c1fce2.js"],"name":"default","async":false}
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Launchd 简明指南 -  Mac 上最强大的后台管理工具 | 窠臼.blog"}],["$","meta","2",{"name":"description","content":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","6",{"rel":"canonical","href":"https://tailwind-nextjs-starter-blog.vercel.app/blog/drafts/launchd-explained"}],["$","link","7",{"rel":"alternate","type":"application/rss+xml","href":"https://tailwind-nextjs-starter-blog.vercel.app/feed.xml"}],["$","meta","8",{"property":"og:title","content":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}],["$","meta","9",{"property":"og:description","content":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}],["$","meta","10",{"property":"og:url","content":"https://tailwind-nextjs-starter-blog.vercel.app/blog/drafts/launchd-explained"}],["$","meta","11",{"property":"og:site_name","content":"窠臼.blog"}],["$","meta","12",{"property":"og:locale","content":"en_US"}],["$","meta","13",{"property":"og:type","content":"article"}],["$","meta","14",{"property":"article:published_time","content":"2023-08-12T00:00:00.000Z"}],["$","meta","15",{"property":"article:modified_time","content":"2023-08-12T00:00:00.000Z"}],["$","meta","16",{"property":"article:author","content":"thekoc"}],["$","meta","17",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","18",{"name":"twitter:title","content":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}],["$","meta","19",{"name":"twitter:description","content":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}],["$","meta","20",{"name":"next-size-adjust"}]]
3:[null,["$","html",null,{"lang":"en-us","className":"__variable_8c5df3 scroll-smooth","suppressHydrationWarning":true,"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/static/favicons/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/static/favicons/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/static/favicons/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/site.webmanifest"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}],["$","body",null,{"className":"bg-white text-black antialiased dark:bg-gray-950 dark:text-white","children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined",["$","$L7",null,{"async":true,"defer":true,"data-website-id":"$undefined","src":"https://analytics.umami.is/script.js"}],"$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-10","children":[["$","div",null,{"children":["$","$L9",null,{"href":"/","aria-label":"窠臼.blog","children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","div",null,{"className":"mr-3","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":50,"height":50,"children":[["$","path",null,{"d":"M7.45 41.676h27.5v-9H7.45Zm0 0","style":{"stroke":"none","fillRule":"evenodd","fill":"#2e3440","fillOpacity":1}}],["$","path",null,{"d":"M16 34.023h27.5v-9H16Zm0 0","style":{"stroke":"none","fillRule":"evenodd","fill":"#f5efda","fillOpacity":1}}],["$","path",null,{"d":"M6.5 29.074H34v-9H6.5Zm0 0","style":{"stroke":"none","fillRule":"evenodd","fill":"#679b49","fillOpacity":1}}],["$","path",null,{"d":"M16 21.398h27.5v-9H16Zm0 0","style":{"stroke":"none","fillRule":"evenodd","fill":"#f08d42","fillOpacity":1}}],["$","path",null,{"d":"M10.2 24h27.5v-9H10.2Zm0 0","style":{"stroke":"none","fillRule":"evenodd","fill":"#f6d21e","fillOpacity":1}}]]}]}],["$","div",null,{"className":"h-6 text-2xl font-semibold sm:block","children":"窠臼.blog"}]]}]}]}],["$","div",null,{"className":"flex items-center leading-5 space-x-4 sm:space-x-6","children":[[["$","$L9",null,{"href":"/blog","className":"hidden sm:block font-medium text-gray-900 dark:text-gray-100","children":"All"}],["$","$L9",null,{"href":"/tags","className":"hidden sm:block font-medium text-gray-900 dark:text-gray-100","children":"Tags"}],["$","$L9",null,{"href":"/about","className":"hidden sm:block font-medium text-gray-900 dark:text-gray-100","children":"About"}]],["$","$La",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"text-gray-900 dark:text-gray-100 h-6 w-6","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lb",null,{}],["$","$Lc",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"childProp":{"current":["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children",["slug","drafts/launchd-explained","c"],"children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lf","$L10",null],"segment":"__PAGE__?{\"slug\":[\"drafts\",\"launchd-explained\"]}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3b2379318c31443c.css","precedence":"next"}]]}],"segment":["slug","drafts/launchd-explained","c"]},"styles":[]}],"segment":"blog"},"styles":[]}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"thekoc"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2023"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"href":"/","children":"窠臼.blog"}]]}],["$","div",null,{"className":"mb-8 text-sm text-gray-500 dark:text-gray-400","children":["$","div",null,{"children":["Based on ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/timlrx/tailwind-nextjs-starter-blog","children":"Tails Azimuth's project."}]]}]}]]}]}]]}]}]]}]}]]}],null]
11:I{"id":2630,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","797:static/chunks/app/blog/[...slug]/page-cadd8fdc01fae17f.js"],"name":"","async":false}
12:I{"id":2529,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","797:static/chunks/app/blog/[...slug]/page-cadd8fdc01fae17f.js"],"name":"","async":false}
13:I{"id":5940,"chunks":["685:static/chunks/685-73da46ad6e4d41f0.js","797:static/chunks/app/blog/[...slug]/page-cadd8fdc01fae17f.js"],"name":"","async":false}
10:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Launchd 简明指南 -  Mac 上最强大的后台管理工具\",\"datePublished\":\"2023-08-12T00:00:00.000Z\",\"dateModified\":\"2023-08-12T00:00:00.000Z\",\"description\":\"Launchd 简明指南 -  Mac 上最强大的后台管理工具\",\"url\":\"https://tailwind-nextjs-starter-blog.vercel.app/blog/drafts/launchd-explained\",\"author\":[{\"@type\":\"Person\",\"name\":\"thekoc\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$L11",null,{}],["$","article",null,{"children":["$","div",null,{"className":"xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700","children":[["$","header",null,{"className":"pt-6 xl:pb-6","children":["$","div",null,{"className":"space-y-1 text-center","children":[["$","dl",null,{"className":"space-y-10","children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":["$","time",null,{"dateTime":"2023-08-12T00:00:00.000Z","children":"Saturday, August 12, 2023"}]}]]}]}],["$","div",null,{"children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"Launchd 简明指南 -  Mac 上最强大的后台管理工具"}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0","children":[["$","dl",null,{"className":"pb-10 pt-6 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700","children":[["$","dt",null,{"className":"sr-only","children":"Authors"}],["$","dd",null,{"children":["$","ul",null,{"className":"flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8","children":[["$","li","thekoc",{"className":"flex items-center space-x-2","children":[["$","img",null,{"src":"/static/images/avatar.jpg","width":38,"height":38,"alt":"avatar","className":"h-10 w-10 rounded-full"}],["$","dl",null,{"className":"whitespace-nowrap text-sm font-medium leading-5","children":[["$","dt",null,{"className":"sr-only","children":"Name"}],["$","dd",null,{"className":"text-gray-900 dark:text-gray-100","children":"thekoc"}],["$","dt",null,{"className":"sr-only","children":"Twitter"}],["$","dd",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/thekoc","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"@thekoc"}]}]]}]]}]]}]}]]}],["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":[["$","div",null,{"className":"prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","h2",null,{"id":"前言","children":[["$","a",null,{"href":"#前言","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"前言"]}],["$","p",null,{"children":"之前用过几次 launchd 来管理一些后台程序，似乎可以运行，却不始终求甚解。心中也一直还有些疑问，比如 launchd, crontab，systemd 是什么关系？它接受哪些命令，起什么作用？配置文件到底怎么写，有哪些选项？"}],["$","p",null,{"children":"最近恰好较为全面地了解了一下 ，就在此记录一下。"}],["$","h2",null,{"id":"launchd-到底是什么","children":[["$","a",null,{"href":"#launchd-到底是什么","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"launchd 到底是什么?"]}],["$","p",null,{"children":"简单来说，launchd 是一个 macOS 上的后台服务管理进程。例如网络进程，文件系统，Finder等等都是由它来启动和管理的。并且它不仅仅是一个后台服务管理进程（如 Supervisord 和 Crontab），它还是一个 init 程序，是系统启动后运行的第个进程（PID 为 1），因此也就在系统中有着特殊的地位。如今 Linux 系统中较流行的 init 程序 systemd 受到过 launchd 的启发。"}],["$","p",null,{"children":["作为一个系统级进程，本身它不会带来什么性能损耗，却着非常强大的功能和配置选项。唯一的缺点就是——有些复杂。繁杂的功能项，XML 格式的配置文件（我",["$","strong",null,{"children":"太爱"}]," XML 了，只可惜 systemd 的配置文件没有用这个格式），官方 2016 年对旧命令的更改，都增加了它的理解难度。"]}],["$","p",null,{"children":"除了这个“小小”的缺点外，可以说launchd 是居家旅行，必备工具了。"}],["$","h2",null,{"id":"基本概念","children":[["$","a",null,{"href":"#基本概念","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"基本概念"]}],["$","p",null,{"children":"简单来说，launchd 会在启动时扫描特定的路径，读取其中的配置文件，再决定是否需要启动对应的程序，并且将这些程序纳入自己的管理范围。这些过程用户不需要操心，因为是系统开机时自动完成的。"}],["$","p",null,{"children":"作为用户，如果我们想禁用或者启用某些服务，或者查看正在运行的服务等，就需要用到 launchctl 这个命令行工具。"}],["$","p",null,{"children":"如果我们想创建自己的后台服务程序，就需要编写配置文件，并且将它放置在特定的路径中。"}],["$","h2",null,{"id":"启动步骤","children":[["$","a",null,{"href":"#启动步骤","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"启动步骤"]}],["$","p",null,{"children":"为了便于理解，一个不是 100% 准确的 launchd 启动步骤是这样的："}],["$","ol",null,{"children":[["$","li",null,{"children":"机器开机，内核启动。"}],["$","li",null,{"children":"内核加载 launchd。"}],["$","li",null,{"children":["launchd 读取 ",["$","code",null,{"children":"/System/Library/LaunchDaemons"}]," 和 ",["$","code",null,{"children":"/Library/LaunchDaemons"}]," 中的 ",["$","code",null,{"children":"plist"}]," 文件，运行满足条件的进程（并不是所有的进程都会被马上执行）。"]}],["$","li",null,{"children":"启动用户登录窗口（也就是我们输入密码的页面）。"}],["$","li",null,{"children":"用户通过图形页面登录系统。"}],["$","li",null,{"children":["launchd 读取 ",["$","code",null,{"children":"/System/Library/LaunchAgents"}],"，",["$","code",null,{"children":"/Library/LaunchAgents"}],"和 ",["$","code",null,{"children":"~/Library/LaunchAgents"}]," 中的配置文件，并且启动满足条件的进程。"]}],["$","li",null,{"children":"用户使登录后，也可以手动输入命令让 launchd 加载配置文件。"}]]}],["$","h2",null,{"id":"配置文件格式","children":[["$","a",null,{"href":"#配置文件格式","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"配置文件格式"]}],["$","p",null,{"children":["配置文件是一个以 ",["$","code",null,{"children":".plist"}]," 结尾的文件，我们通过配置文件来告诉 launchd 程序何时启动，启动后做些什么。"]}],["$","p",null,{"children":["配置文件的格式和参数近年来发生了一些改变，所以网络上（包括官方提供的）教程都会有不准确的地方。所幸 macOS 系统自带了及时更新的",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"x-man-page://launchd.plist","children":"操作手册"}],"，你可以在命令行中输入 ",["$","code",null,{"children":"man launchd.plist"}]," 来查看。"]}],["$","div",null,{"children":["$","img",null,{"alt":"","src":"/static/images/man-launchd-plist.png","width":"1364","height":"910"}]}],["$","h3",null,{"id":"存放路径","children":[["$","a",null,{"href":"#存放路径","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"存放路径"]}],["$","p",null,{"children":"配置文件可以存放在以下位置，区别如下："}],["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"文件夹"}],["$","th",null,{"children":"用途"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"/系统/资源库/LaunchDaemons"}],["$","td",null,{"children":"Apple 提供的系统守护进程"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"/系统/资源库/LaunchAgents"}],["$","td",null,{"children":"Apple 提供的基于每个用户且所有用户适用的代理"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"/资源库/LaunchDaemons"}],["$","td",null,{"children":"第三方系统守护进程"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"/资源库/LaunchAgents"}],["$","td",null,{"children":"基于每个用户且所有用户适用的第三方代理"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"~/资源库/LaunchAgents"}],["$","td",null,{"children":"仅适用于登录用户的第三方代理"}]]}]]}]]}],["$","h3",null,{"id":"配置文件基本格式","children":[["$","a",null,{"href":"#配置文件基本格式","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"配置文件基本格式"]}],["$","p",null,{"children":"下面是一个简单的例子："}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token prolog","children":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token doctype","children":[["$","span",null,{"className":"token punctuation","children":"<!"}],["$","span",null,{"className":"token doctype-tag","children":"DOCTYPE"}]," ",["$","span",null,{"className":"token name","children":"plist"}]," ",["$","span",null,{"className":"token name","children":"PUBLIC"}]," ",["$","span",null,{"className":"token string","children":"\"-//Apple//DTD PLIST 1.0//EN\""}]," ",["$","span",null,{"className":"token string","children":"\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\""}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"plist"]}]," ",["$","span",null,{"className":"token attr-name","children":"version"}],["$","span",null,{"className":"token attr-value","children":[["$","span",null,{"className":"token punctuation attr-equals","children":"="}],["$","span",null,{"className":"token punctuation","children":"\""}],"1.0",["$","span",null,{"className":"token punctuation","children":"\""}]]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"dict"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Label",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"com.example.touchsomefile",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"ProgramArguments",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"array"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"touch",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"/tmp/helloworld",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"array"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"StartInterval",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"300",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"dict"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"plist"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}]]}]}],["$","p",null,{"children":"这个配置文件包含了三个主要的值："}],["$","ol",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"Label"}]," 程序的标识符，必须是唯一的。"]}],["$","li",null,{"children":[["$","code",null,{"children":"ProgramArguments"}]," 程序的路径和参数。"]}],["$","li",null,{"children":[["$","code",null,{"children":"StartInterval"}]," 程序重复运行的间隔。"]}]]}],["$","p",null,{"children":["比如在例子中，程序标识符为 ",["$","code",null,{"children":"com.example.touchsomefile"}],"，运行的命令为 ",["$","code",null,{"children":"touch /tmp/helloworld"}],"，每隔 ",["$","code",null,{"children":"300"}]," 秒便会执行一次。"]}],["$","h3",null,{"id":"keepalive","children":[["$","a",null,{"href":"#keepalive","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"KeepAlive"]}],["$","p",null,{"children":["如果你的程序是需要一直运行的后台程序，可以把 ",["$","code",null,{"children":"StartInterval"}]," 替换成 ",["$","code",null,{"children":"KeepAlive"}],"。"]}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"KeepAlive",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"true"]}],["$","span",null,{"className":"token punctuation","children":"/>"}]]}],"\n"]}]]}]}],["$","p",null,{"children":["程序退出后，launchd 会自动重新启动该程序。默认情况下重启的间隔不能少于 10 秒，这个值可以通过 ",["$","code",null,{"children":"ThrottleInterval"}]," 键来修改。"]}],["$","p",null,{"children":[["$","code",null,{"children":"KeepAlive"}]," 除了 ",["$","code",null,{"children":"true"}]," 以外，还可以设置为很多值，例如 ",["$","code",null,{"children":"SuccessfulExit"}],", ",["$","code",null,{"children":"PathState"}],", ",["$","code",null,{"children":"OtherJobEnabled"}]," 等。",["$","code",null,{"children":"NetworkState"}]," 现在已经被废弃。详细情况可查看操作手册。"]}],["$","h3",null,{"id":"日历时间","children":[["$","a",null,{"href":"#日历时间","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"日历时间"]}],["$","p",null,{"children":["类似 Crontab，launchd 也可以配置程序按照日历时间来运行，例如每周一下午三点。只需要把 ",["$","code",null,{"children":"StartInterval"}]," 更改成 ",["$","code",null,{"children":"StartCalendarInterval"}]," 即可。"]}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"StartCalendarInterval",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"dict"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Minute",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"45",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Hour",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"13",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Day",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"7",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Weekday",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integeer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"1",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Month",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"integeer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"12",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"integer"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"dict"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":[["$","code",null,{"children":"StartCalendarInterval"}]," 中不是所有键都必须填写，例如把 ",["$","code",null,{"children":"Hour"}]," 键去掉，就等同于 Crontab 中的通配符 (",["$","code",null,{"children":"*"}],")，在其他条件满足的前提下每小时都会运行一次。"]}],["$","h3",null,{"id":"监听文件变化","children":[["$","a",null,{"href":"#监听文件变化","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"监听文件变化"]}],["$","p",null,{"children":["除了按照时间间隔和日历外，launchd 也支持监听文件变化，",["$","code",null,{"children":"WatchPaths"}]," 键："]}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"WatchPaths",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"array"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"/etc/hostconfig",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"array"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}]]}]}],["$","p",null,{"children":["加入后，当 ",["$","code",null,{"children":"/etc/hostconfig"}]," 文件发生变化时，launchd 会启动程序。"]}],["$","h3",null,{"id":"其他启动条件","children":[["$","a",null,{"href":"#其他启动条件","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"其他启动条件"]}],["$","p",null,{"children":["launchd 还支持很多其他启动条件，有兴趣可以查看",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.apple.com/library/archive/technotes/tn2083/_index.html#//apple_ref/doc/uid/DTS10003794-CH1-SUBSECTION37","children":"官方文档"}],"。"]}],["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Criterion"}],["$","th",null,{"children":"Property List Key"}],["$","th",null,{"children":"Introduced"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"change to file system object"}],["$","td",null,{"children":"WatchPaths"}],["$","td",null,{"children":"10.4"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"non-empty directory"}],["$","td",null,{"children":"QueueDirectories"}],["$","td",null,{"children":"10.4"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"file system mount"}],["$","td",null,{"children":"StartOnMount"}],["$","td",null,{"children":"10.5"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"periodic"}],["$","td",null,{"children":"StartInterval"}],["$","td",null,{"children":"10.4"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"wall time"}],["$","td",null,{"children":"StartCalendarInterval"}],["$","td",null,{"children":"10.4"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Mach message"}],["$","td",null,{"children":"MachServices"}],["$","td",null,{"children":"10.5"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"connection to a stream socket"}],["$","td",null,{"children":"Sockets"}],["$","td",null,{"children":"10.4"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"traffic to a datagram port"}],["$","td",null,{"children":"Sockets"}],["$","td",null,{"children":"10.4"}]]}]]}]]}],["$","h3",null,{"id":"日志文件","children":[["$","a",null,{"href":"#日志文件","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"日志文件"]}],["$","p",null,{"children":["如果你需要记录运行日志，可以把标准输出/错误输出重定向到文件，只需加入 ",["$","code",null,{"children":"StandardOutPath"}]," 和 ",["$","code",null,{"children":"StandardErrorPath"}]," 这两个键："]}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"StandardOutPath",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"/var/log/myjob.log",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"StandardErrorPath",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"/var/log/myjob.log",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}]]}]}],["$","h2",null,{"id":"limitloadtosessiontype","children":[["$","a",null,{"href":"#limitloadtosessiontype","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],["$","code",null,{"children":"LimitLoadToSessionType"}]]}],["$","p",null,{"children":["这个选项只对存放在 ",["$","code",null,{"children":"LaunchAgent"}]," 文件夹中的配置有效，它决定了程序在哪种 session 下运行。例如，如果你想要程序在图形页面登录时运行，但是不想在 ssh 登录时运行，可以设置为 ",["$","code",null,{"children":"Aqua"}],"（这是默认值）。相反，可以设置为 ",["$","code",null,{"children":"StandardIO"}],"。"]}],["$","$L12",null,{"className":"language-xml","children":["$","code",null,{"className":"code-highlight language-xml","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"LimitLoadToSessionType",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"key"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"<"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"Aqua",["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token tag","children":[["$","span",null,{"className":"token punctuation","children":"</"}],"string"]}],["$","span",null,{"className":"token punctuation","children":">"}]]}],"\n"]}]]}]}],["$","p",null,{"children":"官方提供的技术文档："}],["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Name"}],["$","th",null,{"children":"Session Type"}],["$","th",null,{"children":"Notes"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"GUI launchd agent"}],["$","td",null,{"children":"Aqua"}],["$","td",null,{"children":"Has access to all GUI services; much like a login item."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"non-GUI launchd agent"}],["$","td",null,{"children":"StandardIO"}],["$","td",null,{"children":"Runs only in non-GUI login sessions (most notably, SSH login sessions)"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"per-user launchd agent"}],["$","td",null,{"children":"Background"}],["$","td",null,{"children":"Runs in a context that's the parent of all contexts for a given user"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"pre-login launchd agent"}],["$","td",null,{"children":"LoginWindow"}],["$","td",null,{"children":"Runs in the loginwindow context"}]]}]]}]]}],["$","h3",null,{"id":"其他配置","children":[["$","a",null,{"href":"#其他配置","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"其他配置"]}],["$","p",null,{"children":["此外，也通过 ",["$","code",null,{"children":"UserName"}]," 或者 ",["$","code",null,{"children":"UID"}]," 来指定运行程序的用户（注意，这可能会涉及到权限问题）。通过 ",["$","code",null,{"children":"WorkingDirectory"}]," 来配置工作目录。通过 ",["$","code",null,{"children":"RootDirectory"}]," 来配置根目录。还有三十多项其他配置，本章就不详细展开了。"]}],["$","h2",null,{"id":"launchctl","children":[["$","a",null,{"href":"#launchctl","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"Launchctl"]}],["$","p",null,{"children":[["$","code",null,{"children":"launchctl"}]," 是直接和我们打交道的命令行工具，",["$","code",null,{"children":"launchd"}]," 和 ",["$","code",null,{"children":"launchctl"}]," 就像 Linux 中的 ",["$","code",null,{"children":"systemd"}]," 和 ",["$","code",null,{"children":"systemctl"}],"，一个是后端程序，一个是用户用来和后端交互的命令行程序。",["$","code",null,{"children":"launchd"}]," 负责实际管理后台进程，",["$","code",null,{"children":"launchctl"}]," 则让我们可以手动禁止/启用/重启/查看后台进程。"]}],["$","h3",null,{"id":"旧方法-vs-新方法","children":[["$","a",null,{"href":"#旧方法-vs-新方法","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"旧方法 vs 新方法"]}],["$","p",null,{"children":"在 2016 年左右大幅改动了 launchd 的命令，原来的命令"}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl load ",["$","span",null,{"className":"token variable parameter","children":"-w"}]," ",["$","span",null,{"className":"token operator","children":"<"}],"plist-file-path",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":"被标注为不建议继续使用，取而代之的是"}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl bootstrap ",["$","span",null,{"className":"token operator","children":"<"}],"domian-target",["$","span",null,{"className":"token operator","children":">"}]," ",["$","span",null,{"className":"token operator","children":"<"}],"plist-file-path",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":["为什么要做出这个改变呢？其实就是为了这个新加入的参数 ",["$","code",null,{"children":"<domain-target>"}],"。"]}],["$","p",null,{"children":"在 macOS 中，运行的程序有“域”（domain）的概念。域其实就是程序运行的一个命名空间，可以用作权限管理还有程序命名空间隔离。"}],["$","p",null,{"children":["如果是系统级别的后台进程，则应该在系统启动时启动，并且不会随着用户登出关闭。但是用户级别的后台进程，例如大家都很熟悉的 Dock （屏幕下方的程序坞），则是每个登录的用户都有一个属于自己的实例。并且在登出后也会对应关闭。如果没有命名空间的话，同样名字的 Dock 程序可能会互相冲突。因此，根据用户 ID 不通，不同的 Dock 实例运行在不同的 ",["$","code",null,{"children":"gui/<uid>"}]," 域中。而系统级的进程则在 ",["$","code",null,{"children":"system"}]," 域中。"]}],["$","p",null,{"children":["一般的流程中，运行在哪个域中是系统在启动过程中自动决定的，但是由于 ",["$","code",null,{"children":"launchctl load"}]," 命令的存在，用户可以在系统启动完成后再手动载入。这个时候问题就出现了，当用户运行 ",["$","code",null,{"children":"launchctl load"}]," 命令时，到底应该载入到哪个域中？之前的方法是，用户在哪个域中执行的改命令，就载入到哪个域中，如果用户用 ",["$","code",null,{"children":"sudo"}]," 命令载入的话，就在 ",["$","code",null,{"children":"system"}]," 中运行。但是如果我用 A 用户登录，却想载入到 B 用户的域中呢？或者如果我用图形页面登录，却想载入到 ",["$","code",null,{"children":"ssh"}]," 的域中呢？"]}],["$","h3",null,{"id":"launchctl-bootstrap-命令","children":[["$","a",null,{"href":"#launchctl-bootstrap-命令","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],["$","code",null,{"children":"launchctl bootstrap"}]," 命令"]}],["$","p",null,{"children":["旧命令 ",["$","code",null,{"children":"launchctl load"}]," 无法主动指定加载的域，但如果使用新命令 ",["$","code",null,{"children":"launchctl bootstrap"}],"，就可以在参数 ",["$","code",null,{"children":"domain-target"}]," 中指定。操作手册中中列出了五个域，分别是 ",["$","code",null,{"children":"system"}],", ",["$","code",null,{"children":"gui"}],", ",["$","code",null,{"children":"login"}],", ",["$","code",null,{"children":"user"}]," 和 ",["$","code",null,{"children":"pid"}],"。除了这些以外，还存在别的域，但是实际上我们日常使用最多的只有 ",["$","code",null,{"children":"system"}]," 和 ",["$","code",null,{"children":"gui/<uid>"}],"，可能还有 ",["$","code",null,{"children":"user/<uid>"}],"。"]}],["$","p",null,{"children":"例如，如果我们要把载入到当前登录用户的域中，可以使用"}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl bootstrap gui/",["$","span",null,{"className":"token variable","children":[["$","span",null,{"className":"token variable","children":"$$("}],["$","span",null,{"className":"token function","children":"id"}]," ",["$","span",null,{"className":"token variable parameter","children":"-u"}],["$","span",null,{"className":"token variable","children":")"}]]}]," ",["$","span",null,{"className":"token operator","children":"<"}],"plist-file-path",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":["其中gui 代表图形页面，",["$","code",null,{"children":"$$(id -u)"}]," 则用来获取当前用户的 UID。"]}],["$","p",null,{"children":"如果要载入到系统域中，则可以使用："}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token function","children":"sudo"}]," launchctl bootstrap system ",["$","span",null,{"className":"token operator","children":"<"}],"plist-file-path",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":"一般而言，我们要么载入到当前用户的域中，要么载入到系统域中，所以大部分情况下这两个命令就够用了。你也可以加载到其他用户的域中，例如："}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token function","children":"sudo"}]," launchctl bootstrap user/502 ",["$","span",null,{"className":"token operator","children":"<"}],"plist-file-path",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","h3",null,{"id":"launchctl-bootout-命令","children":[["$","a",null,{"href":"#launchctl-bootout-命令","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],["$","code",null,{"children":"launchctl bootout"}]," 命令"]}],["$","p",null,{"children":["除了 ",["$","code",null,{"children":"launchctl load"}]," 以外，原本的 ",["$","code",null,{"children":"launchctl unload"}]," 也被 ",["$","code",null,{"children":"launchctl bootout"}]," 替代。用法类似，例如："]}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl bootout ",["$","span",null,{"className":"token operator","children":"<"}],"domain-target",["$","span",null,{"className":"token operator","children":">"}],"/",["$","span",null,{"className":"token operator","children":"<"}],"service-id",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":"例如："}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl bootout gui/",["$","span",null,{"className":"token variable","children":[["$","span",null,{"className":"token variable","children":"$$("}],["$","span",null,{"className":"token function","children":"id"}]," ",["$","span",null,{"className":"token variable parameter","children":"-u"}],["$","span",null,{"className":"token variable","children":")"}]]}],"/com.example.touchsomefile\n"]}]}]}],["$","p",null,{"children":["注意，用 ",["$","code",null,{"children":"launchctl bootout"}]," 命令卸载的程序，下次重启以后还是会被自动载入。如果想要禁止自动载入，需要使用 ",["$","code",null,{"children":"launchctl disable"}]," 命令。"]}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl disable ",["$","span",null,{"className":"token operator","children":"<"}],"domain-target",["$","span",null,{"className":"token operator","children":">"}],"/",["$","span",null,{"className":"token operator","children":"<"}],"service-id",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","h3",null,{"id":"launchctl-print-命令","children":[["$","a",null,{"href":"#launchctl-print-命令","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],["$","code",null,{"children":"launchctl print"}]," 命令"]}],["$","p",null,{"children":["这个命令是用来替换原来的 ",["$","code",null,{"children":"launchctl list"}]," 命令的。使用的时候也需要指定域，例如："]}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl print gui/",["$","span",null,{"className":"token variable","children":[["$","span",null,{"className":"token variable","children":"$$("}],["$","span",null,{"className":"token function","children":"id"}]," ",["$","span",null,{"className":"token variable parameter","children":"-u"}],["$","span",null,{"className":"token variable","children":")"}]]}],"\n"]}]}]}],["$","p",null,{"children":"会显示当前登录用户的所有后台进程。不过要注意，输出的格式并不能保证会一直不变，引用官方的说明："}],["$","blockquote",null,{"children":["$","p",null,{"children":"IMPORTANT: This output is NOT API in any sense at all. Do NOT rely on the structure or information emitted for ANY reason. It may change from release to release without warning."}]}],["$","p",null,{"children":["这里还要详细说明一下，域是有层次关系的，例如 ",["$","code",null,{"children":"system"}]," 作为最顶级的域，下面有每个用户对应的 ",["$","code",null,{"children":"user"}]," 域，再之下又有 ",["$","code",null,{"children":"login"}]," 域，代表的是用户每次登录的 session，例如 ",["$","code",null,{"children":"gui/501"}]," 代表的是用户 501 通过图形登录的 session。而他们之间的读取权限关系是，子域可以读取父域的服务，但是父域不能读取子域的服务，同级之间也不能互相看到运行的服务。例如 ",["$","code",null,{"children":"launchctl print gui/501"}]," 会打印出系统级的服务，但是 ",["$","code",null,{"children":"launchctl print system"}]," 不会打印出用户级的服务。"]}],["$","h3",null,{"id":"其他命令","children":[["$","a",null,{"href":"#其他命令","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"其他命令"]}],["$","p",null,{"children":["如果想要强制重启某个服务，可以使用 ",["$","code",null,{"children":"launchctl kickstart"}]," 命令。"]}],["$","$L12",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash code-highlight","children":["$","span",null,{"className":"code-line","children":["    launchctl kickstart ",["$","span",null,{"className":"token variable parameter","children":"-k"}]," ",["$","span",null,{"className":"token operator","children":"<"}],"domain-target",["$","span",null,{"className":"token operator","children":">"}],"/",["$","span",null,{"className":"token operator","children":"<"}],"service-id",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","h2",null,{"id":"总结","children":[["$","a",null,{"href":"#总结","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"总结"]}],["$","p",null,{"children":["launchd 和 launchctl 常见的用法就是这些了。由于这两个组件实在是太过复杂，还有很多用法和细节没有提及，这些可以参考系统内置的 ",["$","code",null,{"children":"man"}]," 页面。如果你想更深入了解系统的底层架构，下面有一些官方参考资料从系统层面做了一些较深入的解释。"]}],["$","h2",null,{"id":"参考资料","children":[["$","a",null,{"href":"#参考资料","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"icon icon-link"}]}],"参考资料"]}],["$","ol",null,{"children":[["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://ss64.com/osx/launchctl.html","children":"Man Page"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://gist.github.com/masklinn/a532dfe55bdeab3d60ab8e46ccc38a68","children":"CheatSheet"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://babodee.wordpress.com/2016/04/09/launchctl-2-0-syntax/","children":"LAUNCHCTL 2.0 SYNTAX"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://medium.com/@chetcorcos/a-simple-launchd-tutorial-9fecfcf2dbb3","children":"A Simple Launchd Tutorial"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://support.apple.com/en-hk/guide/terminal/apdc6c1077b-5d5d-4d35-9c19-60f2397b2369/2.13/mac/13.0","children":"Script management with launchd in Terminal on Mac"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html#//apple_ref/doc/uid/10000172i-SW1-SW1","children":"Daemons and Services Programming Guide"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.apple.com/library/archive/technotes/tn2083/_index.html#//apple_ref/doc/uid/DTS10003794","children":"Daemons and Agents"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.apple.com/forums/thread/16206","children":"What is service-target"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://apple.stackexchange.com/questions/366281/launchd-confusion-on-semantics-of-bootstrap-and-bootout-etc-after-reading-manu","children":"launchd: Confusion on semantics of bootstrap and bootout etc. after reading manual pages"}]}],["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.apple.com/library/archive/documentation/Darwin/Conceptual/KernelProgramming/contexts/contexts.html#//apple_ref/doc/uid/TP30000905-CH212-BEHJDFCA","children":"Bootstrap Contexts"}]}]]}]]}],["$","div",null,{"className":"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300","id":"comment","children":["$","$L13",null,{"slug":"drafts/launchd-explained"}]}]]}],["$","footer",null,{"children":[["$","div",null,{"className":"divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y","children":[["$","div",null,{"className":"py-4 xl:py-8","children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Tags"}],["$","div",null,{"className":"flex flex-wrap","children":[["$","$L9",null,{"href":"/tags/macos","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"macos"}],["$","$L9",null,{"href":"/tags/launchd","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"launchd"}],["$","$L9",null,{"href":"/tags/apple","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"apple"}]]}]]}],["$","div",null,{"className":"flex justify-between py-4 xl:block xl:space-y-8 xl:py-8","children":[["$","div",null,{"children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Previous Article"}],["$","div",null,{"className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":["$","$L9",null,{"href":"/blog/nginx-https-upstream","children":"Nginx 反向代理 HTTPS 上游服务器"}]}]]}],["$","div",null,{"children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Next Article"}],["$","div",null,{"className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":["$","$L9",null,{"href":"/blog/github-actions","children":"通过 GitHub Actions 自动化部署宇宙万物"}]}]]}]]}]]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"href":"/blog","className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","aria-label":"Back to the blog","children":"← Back to the blog"}]}]]}]]}]]}]}]]}]]
f:null
